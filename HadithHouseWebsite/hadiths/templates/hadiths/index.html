{% load static %}

<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <!-- TODO: Is it OK to keep Google Site verification meta-data? -->
  <meta name="google-site-verification" content="GrYjmJUBaIei8LmgWjl-YTJNa-vdtr0rcDGBI58mN2U"/>

  <title>Hadith House</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- jQuery-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <!-- Angular -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-route.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-resource.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.11.0/angular-material.min.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.11.0/angular-material.min.css">
  <script
      src="https://cdnjs.cloudflare.com/ajax/libs/angular-material-icons/0.5.0/angular-material-icons.min.js"></script>

  <!-- Bootstrap -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">

  <!-- Underscore -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
</head>
<body layout="column" ng-app="HadithHouseApp" ng-controller="HadithHouseCtrl as ctrl">

<!-- Facebook Authentication -->
<script>
  var fbApiInit = false;

  window.fbAsyncInit = function () {
    FB.init({
      appId: '{{ appId }}',
      xfbml: true,
      version: 'v2.4'
    });

    fbApiInit = true;

    // If Angular is already initialized, manually call $digest of the body
    // to trigger the handler of any $watch on fbLoginStatus.
    if (angular) {
      var bodyScope = angular.element('body').scope();
      bodyScope.$digest();
    }
  };

  (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) {
      return;
    }
    js = d.createElement(s);
    js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<md-toolbar layout="row">
  <div class="md-toolbar-tools">
    <md-button ng-click="ctrl.toggleSideNav('left')" hide-gt-sm class="md-icon-button">
      <!-- TODO: Use an icon from Angular Material rather than the hardcoded link. -->
      <md-icon aria-label="Menu" md-svg-icon="https://s3-us-west-2.amazonaws.com/s.cdpn.io/68133/menu.svg"></md-icon>
    </md-button>
    <h1>Hadith House</h1>

    <span flex></span>
    <md-button ng-if="ctrl.fetchedLoginStatus && ctrl.fbUser === null"
               ng-click="ctrl.fbLogin()">
      Login with Facebook
    </md-button>

    {% verbatim %}
    <div ng-if="ctrl.fetchedLoginStatus && ctrl.fbUser !== null">
      <md-menu>
        <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button">
          <img ng-if="ctrl.fbUser.profilePicUrl" ng-src="{{ ctrl.fbUser.profilePicUrl }}"/>
        </md-button>

        <md-menu-content width="4">
          <md-menu-item>
            <md-button ng-href="{{ ctrl.fbUser.link }}">Profile</md-button>
          </md-menu-item>
          <md-menu-item>
            <md-button ng-click="ctrl.fbLogout()">Logout</md-button>
          </md-menu-item>
        </md-menu-content>
      </md-menu>
    </div>
    {% endverbatim %}
  </div>
</md-toolbar>

{% verbatim %}
<div layout="row" flex>
  <md-sidenav class="site-sidenav md-sidenav-left md-whiteframe-z2"
              md-component-id="left"
              md-is-locked-open="$mdMedia('gt-sm')">

    <md-list>
      <md-list-item ng-repeat="item in ctrl.items">
        <md-button ng-click="ctrl.selectItem(item)" ng-class="{'selected' : item === ctrl.selected }">
          {{ item.name }}
        </md-button>
      </md-list-item>
    </md-list>

  </md-sidenav>


  <div flex layout="column" tabIndex="-1" role="main" class="md-whiteframe-z2">
    <md-content flex id="content">
      <div style="height: 10px;">
        <md-progress-linear md-mode="indeterminate" ng-show="pendingRequests > 0"></md-progress-linear>
      </div>
      <div ng-view></div>
    </md-content>
  </div>
</div>

{% endverbatim %}

<script>
  function getHtmlBasePath() {
    return '{% static 'hadiths/html' %}/';
  }

  function getApiUrl() {
    return '/apis/';
  }
</script>
<link rel="stylesheet" href="{% static 'hadiths/css/styles.css' %}">
<script src="{% static 'hadiths/js/app.js' %}"></script>
<script src="{% static 'hadiths/js/addhadithdlg.js' %}"></script>
<script src="{% static 'hadiths/js/addtagdlg.js' %}"></script>
<script src="{% static 'hadiths/js/person.js' %}"></script>
<script src="{% static 'hadiths/js/persons.js' %}"></script>
<script src="{% static 'hadiths/js/hadith.js' %}"></script>
<script src="{% static 'hadiths/js/hadiths.js' %}"></script>
<script src="{% static 'hadiths/js/tags.js' %}"></script>
<script src="{% static 'hadiths/js/persons.service.js' %}"></script>
<script src="{% static 'hadiths/js/hadiths.service.js' %}"></script>
<script src="{% static 'hadiths/js/tags.service.js' %}"></script>
<script src="{% static 'hadiths/js/toast.service.js' %}"></script>
<script src="{% static 'hadiths/js/tagselector.directive.js' %}"></script>
<script src="{% static 'hadiths/js/personselector.directive.js' %}"></script>
<script src="{% static 'hadiths/js/facebook.service.js' %}"></script>

</body>
</html>
