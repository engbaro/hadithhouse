<span>
  <span ng-if="ctrl.textOnly !== 'true'">
    <md-chips ng-model="ctrl.entities" readonly="ctrl.readOnly"
              md-autocomplete-snap
              md-require-match="true">
      <md-autocomplete
          md-selected-item="ctrl.selectedTag"
          md-selected-item-change=""
          md-search-text="ctrl.query"
          md-search-text-change=""
          md-items="entity in ctrl.findEntities(ctrl.query)"
          md-item-text="ctrl.entityToString(entity)"
          placeholder="Search for a {{ ctrl.type }}">
        <md-item-template>
          <span md-highlight-text="ctrl.query">{{ ctrl.entityToString(entity) }}</span>
        </md-item-template>
        <md-not-found>
          No matches found for "{{ ctrl.query }}".
        </md-not-found>
      </md-autocomplete>
      <md-chip-template>
        <span ng-if="ctrl.clickable !== 'true' || !ctrl.readOnly">
          <strong>{{ ctrl.entityToString($chip) }}</strong>
        </span>
        <a ng-href="#/{{ ctrl.type }}/{{ $chip.id }}" ng-if="ctrl.clickable === 'true' && ctrl.readOnly">
          {{ ctrl.entityToString($chip) }}
        </a>
      </md-chip-template>
    </md-chips>
  </span>
  <!-- TODO: text-only mode supports only one element at the moment. -->
  <span ng-if="ctrl.textOnly === 'true' && ctrl.clickable !== 'true'">{{ ctrl.entityToString(ctrl.entities[0]) }}</span>
  <a ng-href="#/{{ ctrl.type }}/{{ ctrl.entities[0].id }}" ng-if="ctrl.textOnly === 'true' && ctrl.clickable ==='true'">
    {{ ctrl.entityToString(ctrl.entities[0]) }}</a>
</span>
